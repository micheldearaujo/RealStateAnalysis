library(ggpubr)
# O pacote nortest fornece funções para testar normalidade de distribuições estatísticas.
require(nortest)
# O pacote RColorBrewer fornece várias paletas de cores extras para os gráficos.
library(RColorBrewer)
# O pacote rnaturalearth fornece conexão com dados de mapas da Natural Earth. Com ele, vamos baixar o mapa do Brasil dividido em estados
library(rnaturalearth)
# Este pacote serve para criar intervalos discretos de variáveis contínuas.
library(classInt)
# O pacote sf fornece uma série de ferramentas para trabalhar com vetores geoespaciais, como pontos, linhas e poligonos. Vamos utilizá-lo para gerar geo-dataframes.
library(sf)
# O pacote geobr é parecido com o rnaturalearth. Contudo, ele possui mais informações específicas ao Brasil, como mapas municipais e sensos.
library(geobr)
# As strings possuem muitos acentos, então é recomendável escolher o encoding como 'latin' para que todos
# os caracteres sejam reconhecidos.
#anuncios <- read.csv('housing_prices.csv', encoding='latin')
anuncios <- read.csv('housing_prices.csv')
print('Estrutura do dataset: ')
str(anuncios)
print('Algumas linhas')
head(anuncios, 5)
tail(anuncios, 5)
anuncios$Tipo <- unlist(str_extract_all(pattern='apartamento|casa|sobrado',string=anuncios$Anuncio))
anuncios <- data.frame(Anuncio=anuncios[grepl(pattern='casa|apartamento|sobrado', x=anuncios$Anuncio), ])
anuncios$Tipo <- unlist(str_extract_all(pattern='apartamento|casa|sobrado',string=anuncios$Anuncio))
anuncios$Tipo <- gsub(pattern='apartamento', replacement='AP', x=anuncios$Tipo)
anuncios$Tipo <- gsub(pattern='casa|sobrado', replacement='CS', x=anuncios$Tipo)
dados <- unlist(strsplit(x=anuncios$Anuncio, split='\n'))
head(dados, 10)
anuncios$Preco <- grep(pattern='/mês', x=dados, value=TRUE)
head(data.frame(anuncios[!grepl(pattern='/mês', x=anuncios$Anuncio), ]), 3)
anuncios <- data.frame(anuncios[grepl(pattern='Aluguel|/mês', x=anuncios$Anuncio), ])
dados <- unlist(strsplit(x=anuncios$Anuncio, split='\n'))
anuncios$Preco <- grep(pattern='/mês|Aluguel', x=dados, value=TRUE)
head(anuncios, 2)
anuncios$Preco <- parse_number(x=anuncios$Preco, locale=locale(decimal_mark=',', grouping_mark='.'))
head(anuncios, 2)
anuncios$Area <- grep(pattern='[0-9]+\\sm', x=dados, value=TRUE)
head(anuncios,2)
anuncios$Area <- parse_number(x=anuncios$Area, locale=locale(decimal_mark=',', grouping_mark='.'))
head(anuncios,2)
anuncios$Quartos <- grep(pattern='quartos?', x=dados, value=TRUE)
anuncios <- data.frame(anuncios[grepl(pattern='quartos?', x=anuncios$Anuncio), ]) # Filtrando dataframe
anuncios$Quartos <- grep(pattern='quartos?', x=dados, value=TRUE) # Extraindo a quantidade de quartos
anuncios$Quartos <- parse_number(x=anuncios$Quartos, locale=locale(decimal_mark=',', grouping_mark='.')) # Extraindo o valor numérico
head(anuncios)
dados <- unlist(strsplit(x=anuncios$Anuncio, split='\n'))
anuncios <- data.frame(anuncios[grepl(pattern='banheiros?', x=anuncios$Anuncio), ])
anuncios$Banheiros <- grep(pattern='banheiros?', x=dados, value=T)
anuncios$Banheiros <- parse_number(x=anuncios$Banheiros, locale=locale(decimal_mark=',', grouping_mark='.'))
dados <- unlist(strsplit(x=anuncios$Anuncio, split='\n'))
anuncios$Endereco <- grep(pattern='-', x=dados, value=TRUE)
head(anuncios,2)
anuncios$Estado <- unlist(str_extract_all(pattern='[A-Z]{2}$', string=anuncios$Endereco))
head(anuncios,3)
anuncios$Cidade <- unlist(str_extract_all(pattern=',\\s.*\\s-', string=anuncios$Endereco))
anuncios <- data.frame(anuncios[grepl(pattern=',\\s.*\\s-', x=anuncios$Endereco), ])
dados <- unlist(strsplit(x=anuncios$Anuncio, split='\n'))
anuncios$Cidade <- unlist(str_extract_all(pattern=',\\s.*\\s-', string=anuncios$Endereco))
head(anuncios[3:8,])
cidadeExtract <- function(y){
if (grepl(pattern='[[:digit:]]', x=y)==TRUE){
cidade <- unlist(strsplit(x=y, split=','))[3]
return (cidade)
} else{
return (y)
}
}
anuncios$Cidade <- sapply(X=anuncios$Cidade, FUN=cidadeExtract)
head(anuncios[3:8,])
anuncios$Cidade <- gsub(pattern='[[:punct:]]', replacement='', anuncios$Cidade)
head(anuncios[,2:7],3)
anuncios$Cidade <- str_trim(string=anuncios$Cidade)
anuncios$Endereco <- paste(anuncios$Endereco, 'Brazil', sep=', ')
#anuncios <- geocode(.tbl=anuncios, address='Endereco')
anuncios <- anuncios[!duplicated(anuncios),] # Remove as duplicatas
anuncios <- select(anuncios, -Anuncio) # Exclui a coluna "Anuncio"
head(anuncios, 10)
str(anuncios)
#write.csv(anuncios, 'imoveis.csv')
variaveis <- c('Tipo', 'Preco', 'Area ', 'Quartos', 'Banheiros', 'Endereco', 'Estado', 'Cidade', 'long', 'lat')
descricao <- c('Tipo do imóvel (Casa ou Apartamento).',
'Valor, em reais, do aluguel mensal do imóvel.',
'Valor, em metros quadrados, da área do imóvel.',
'Quantidade de quartos que o imóvel possui. Essa informação não inclui a sala.',
'Quantidade de banheiros na residência.',
'Endereço completo (ou quase) da residência.',
'Estado brasileiro na qual o imóvel está localizado.',
'Município brasileiro no qual a residência está localizada.',
'Longitude (coordenada geográfica) do imóvel. Essa e a próxima informação serão úteis para plotar mapas.',
'Latitude (coordenada geográfica) do imóvel.')
tipo <- c('Caractere', 'Numérico', 'Numérico', 'Numérico', 'Numérico', 'Caractere',
'Caractere', 'Caractere', 'Numérico', 'Numérico')
Resumo <- datatable(data.frame(Variáveis=variaveis, Tipo=tipo, Descrição=descricao))
Resumo
anuncios <- read.csv('imoveis.csv')
#anuncios <- read_csv('imoveis.csv', locale=locale(encoding='latin1'))
head(anuncios,5)
options(scipen=999) # Desativando a notação científica
# Criando um histograma com Plotly
hist1 <- plot_ly(data=anuncios,
type='histogram',
colors=c('#FF5653')) %>%  # Adicionando a cor vermelho para o preço
add_histogram(x=~Preco, # Adicionando o traço
name='Preço',
color='#FF5653') %>%
layout(title='Distribuição dos preços dos imóveis', # Configurando os eixos
xaxis=list(title='Preço'),
yaxis=list(title='Frequência')) %>%
layout(width=800) # Configurando o tamanho da figura
hist1
# Criando a base para o boxplot
plot_ly(data=anuncios,
type='box',
colors=c('#FF5653')) %>%
add_boxplot(y=~Preco,   # Adicionando o traço do boxplot
name='Preço',
color='#FF5653') %>%
layout(width=800,
yaxis=list(title='Valor'))
plot_ly(data=anuncios,
type='box',
colors=c('#157B38')) %>% # Adicionando a cor verde para a área
add_trace(y=~Area,
name='Área (m²)',
color='#157B38') %>%
layout(width=800,               # Aumentando a largura do gráfico
yaxis=list(title='Valor'))
# Removendo outliers:
anunciosf <- anuncios[-which(anuncios$Preco %in% boxplot(anuncios$Preco, plot=F)$out),]
anunciosf <- anunciosf[-which(anunciosf$Area %in% boxplot(anunciosf$Area, plot=F)$out),]
hist1 <- plot_ly(data=anunciosf,
type='histogram') %>%
add_trace(name='Preço',
x=~Preco,
marker=list(color='#FF5653',
line=list(color="rgb(20,20,20)",
width=0.5)),
xbins=10) %>%
layout(title='Distribuição dos preços dos imóveis (sem outliers)',
xaxis=list(title='Preço'),
yaxis=list(title='Frequência'),
width=700)
hist1
# Criando o boxplot do preço com os dados fitlrados
bx1 <- plot_ly(data=anunciosf,
type='box',
colors=c('#FF5653')) %>%
add_boxplot(y=~Preco,
name='Preço',
color='#FF5653') %>%
layout(title='Distribuição dos preços e áreas dos imóveis (sem outliers)',
width=700)
# Criando o boxplot da área com os dados fitlrados
bx2 <- plot_ly(data=anunciosf,
type='box',
colors=c('#157B38')) %>%
add_boxplot(y=~Area,
name='Área',
color='#157B38') %>%
layout(width=700)
fig1 <- subplot(bx1, bx2, nrows=1)
fig1
# Criando um gráfico de dispersão (scatter plot) para a variável Preço
# O gráfico divide Apartamentos e Casas em diferentes cores
plot_ly(data=anunciosf,
type='scatter',
x=~Area,
y=~Preco,
color=~Tipo,
colors=c('#FF5653', '#5A41F3'),
marker = list(size=7),
mode='markers') %>%
layout(title='Relação entre Área e Preço do imóvel',
xaxis=list(title='Área (m²)'),
yaxis=list(title='Preço'),
width=800)
# Criando o primeiro scatter plot, para Preço vs Quartos
sct1 <- plot_ly(data=anunciosf,
type='scatter',
x=~Quartos,
y=~Preco,
color=~Tipo,
colors=c('#FF5653', '#5A41F3'),
marker = list(size=7),
mode='markers') %>%
layout(xaxis=list(title='Quartos', autotick=FALSE, tick0=0, dtick=1),
yaxis=list(title='Preço'),
width = 700)
# Criando o segundo scatter plot, para Preço vs Banheiros
sct2 <- plot_ly(data=anunciosf,
type='scatter',
x=~Banheiros,
y=~Preco,
color=~Tipo,
colors=c('#FF5653', '#5A41F3'),
marker = list(size=7),
mode='markers',
showlegend=F) %>%
layout(xaxis=list(title='Banheiros', autotick=FALSE, tick0=0, dtick=1),
yaxis=list(title='Preço'),
width = 700)
fig2 <- subplot(sct1, sct2, titleX = T, titleY=T, shareY=T, which_layout = c(1,2))
fig2
# Primeiro vamos remover os dados faltantes do dataset
anunciosf <- anunciosf[!is.na(anunciosf$Preco),]
# Teste de correlação Preco vs Quartos
pversusq <- cor(x=anunciosf$Preco, y=anunciosf$Quartos)
paste("O coeficiente de correlação Pearson entre Preco e Quartos é", pversusq)
# Teste de correlação Preco vs Banheiros
pversusb <- cor(x=anunciosf$Preco, y=anunciosf$Banheiros)
paste("O coeficiente de correlação Pearson entre Preco e Banheiros é", pversusb)
# Criando um boxplot em que os dois tipos de imóveis são separados por cores.
bx3 <- plot_ly(data=anunciosf,
color=~Tipo, # Separação
colors=c('#FF5653', '#5A41F3')) %>%
add_boxplot(y=~Preco) %>%
layout(title='Distribuição dos preços dos imóveis',
width=700)
bx3
# Recriando os boxplots apenas para imóveis com 1 quarto, através da função Filter
bx3 <- plot_ly(data=filter(anunciosf, Quartos==1),
color=~Tipo,
colors=c('#FF5653', '#5A41F3')) %>%
add_boxplot(y=~Preco) %>%
layout(title='Distribuição dos preços dos imóveis',
width=700)
bx3
# Verificando a normalidade pelo histograma
hist2 <- plot_ly(data=filter(anunciosf, Quartos==1)) %>%
add_histogram(x=~Preco,
color=~Tipo,
nbinsx=20, # Definindo a quantidade de barras, 5000/250 = 20
colors=c('#FF5653', '#5A41F3')) %>%
layout(xaxis=list(title='Preço', tick0=0, autotick=F, dtick=500), # Especificando a formatação do eixo x.
yaxis=list(title='Frequência'),
title='Verificando a Normalidade do Preço',
width=700)
hist2
# Verificando a normalidade pelo QQ-plot
qqnorm(anunciosf$Preco, main='QQ plot da variável Preço', pch=18)
qqline(anunciosf$Preco)
# Realizando o teste de Anderson-Darling para Casas
ad.test(filter(anunciosf, Quartos==1, Tipo=='CS')$Preco)
# Realizando o teste de Anderson-Darling para Apartamentos
ad.test(filter(anunciosf, Quartos==1, Tipo=='AP')$Preco)
# Realizando o tesde U de Mann-Whitney para variável Preco em função da variável categórica Tipo,
# Com nível de confiança de 95%.
wilcox.test(Preco ~ Tipo,
data=filter(anunciosf, Quartos==1),
conf.level=0.95)
# Agrupando os dados de acordo com a variável categórica Tipo e criando algumas estatísticas
resumo <- anunciosf %>%
group_by(Tipo) %>%
summarise(Quantidade = n(), # A função summarise é muito útil para criar estatísticas
Media.Precos = round(mean(Preco, na.rm=T),2),
DesvioPadrao.Precos = round(sd(Preco, na.rm=T),2),
Media.Quartos = round(mean(Quartos),2),
Media.Banheiros = round(mean(Banheiros),2))
datatable(data=resumo, caption = 'Resumo das variáveis numéricas')
head(select(anunciosf, -c(1:5)), 5)
anunciosf <- data.frame(drop_na(anunciosf))
# Agrupando os dados em relação ao estado para contar as ocorrências e calcular a média de preço por estado
by_state1 <- anunciosf %>%
group_by(Estado) %>%
summarise(Quantidade=n(),
MediaPreco = round(mean(Preco),2)) %>%
arrange(desc(Quantidade, MediaPreco))             # Ordendando a tabela por quantidade de observações
# Criando a tabela com a função datatable, do pacote DT
datatable(data=by_state1, caption='Número de observações e média por estado')
# Realizando o agrupamento por estado e por tipo de imóvel
by_state2 <- anunciosf %>%
group_by(Estado, Tipo) %>%
summarise(Quantidade=n(),               # Contando as ocorrências
MediaPreco = mean(Preco)) %>% # Calculando as médias
arrange(MediaPreco)
bar1 <- plot_ly(data=by_state2,
type='bar',
color=~Tipo,
colors= c('#FF5653', '#5A41F3')) %>%
add_trace(x=~Estado, y=~MediaPreco) %>%
layout(width=800)
bar1
# Lendo o arquivo que contém a média salarial por estado
salarios <- read.csv('salarios.csv', sep=';')
names(salarios)[2] <- 'MediaSalario'
head(salarios, 5)
anunciosg <- merge(x=by_state1,
y=salarios,
by='Estado')
anunciosg$MediaSalario <- parse_number(anunciosg$MediaSalario, locale=locale(decimal_mark=',', grouping_mark = '.'))
# Ordendando o dataframe de acordo com a média dos preços
anunciosg <- arrange(anunciosg, MediaPreco)
# Calculando a proporção entre salário e aluguel medios
anunciosg <- mutate(anunciosg, Proporcao = anunciosg$MediaPreco/anunciosg$MediaSalario)
# Criando um barplot na horizontal que mostra tanto o valor médio do aluguel
# quanto a porcentagem que um aluguel médio custa do salário médio, para cada estado
bar2 <- plot_ly(data=anunciosg, type='bar',
orientation='h',
color=~Proporcao, # As cores mostram o valor da proporção, que vai de 0 a 1.
colors=) %>%
add_trace(y=~Estado,
x=~MediaPreco,
name='Preco') %>%
add_annotations(xref=anunciosg$MediaPreco, yref=anunciosg$Estado,    # Adicionando as porcentagens ao gráfico
y=anunciosg$Estado, x=anunciosg$MediaPreco*1 + 200,
text=paste(round(anunciosg$Proporcao, 2)*100, '%'),
showarrow=F) %>%
layout(title='Proporção entre valor médio de aluguel e salário médio',
xaxis=list(title='Preço Aluguel'),
yaxis=list(title='Estado'),
width=700)
bar2
Acima_da_Media <- filter(anunciosg, Proporcao>1)[-2]
datatable(Acima_da_Media, caption='Estados com alto custo de vida')
# Vamos transformar o dataframe original em um dataframe do tipo sf, atraves da função st_as_sf.
pontos_sf <- st_as_sf(anunciosf, coords=c('long','lat'), crs=4326)
# Baixando o mapa do Brasil, separado por estados.
estados_sf <- ne_states(country='brazil', returnclas='sf')
# Plotando o mapa do Brasil
mapa <- ggplot() +
geom_sf(data=estados_sf, # o ggplot possui uma funcao especial para plotar mapas, a geom_sf
fill=gray(0.85), color=gray(0.7)) +
labs(title='Mapa do Brasil')
mapa
mapa <- ggplot() +
geom_sf(data=estados_sf, # Mapa do Brasil
fill=gray(0.85),
color=gray(0.7)) +
geom_sf(data=pontos_sf,  # um 'scatter plot' espacial das residências
alpha=0.7,
aes(color=Preco), # definindo a cor de acordo com o preço
size=2.5,
show.legend = 'point') +
labs(title='Distribuição dos imóveis no Brasil')
mapa
# Primeiro é necessário unir o dataframe estados_sf com o dataframe que possui as informações das médias dos preços
new.df <- merge(x=estados_sf, y=anunciosg,
by.x ='postal', by.y='Estado', all=T)
# Criando intervalos discretos para a variável Preco
breaks_media <- classIntervals(c(min(anunciosg$MediaPreco) - 0.00001, anunciosg$MediaPreco), n=7, style='quantile')
# Transformando a variável preço em categorias
new.df <- mutate(new.df, MediaPrecoCat = cut(MediaPreco, breaks_media$brks))
# Renomeando os nomes das categorias
levels(new.df$MediaPrecoCat) <- c('(1000,1210]', '(1210,1390]', '(1390,1580]', '(1580,1780]',
'(1780,2000]','(2000,2070]', '(2070,2850]')
mapa2 <- ggplot() +
geom_sf(data=new.df,
aes(fill=MediaPrecoCat)) + # Preenchendo os estados de acordo com a média do preço
scale_fill_brewer(palette='OrRd') +
labs(title='Média de preço por Estado',
fill='Preço Médio')
mapa2
# Mapa da proporcao
# Criando intervalos para a proporção, que já foi calculada anteriormente.
breaks_prop <- classIntervals(c(min(anunciosg$Proporcao) - 0.00001, anunciosg$Proporcao), n=7, style='quantile')
# Transformando
new.df <- mutate(new.df, ProporcaoCat = cut(Proporcao, breaks_prop$brks))
# Criando o mapa
mapa3 <- ggplot() +
geom_sf(data=new.df,
aes(fill=ProporcaoCat)) +       # Preenchendo de acordo com o valor da proporção
scale_fill_brewer(palette='OrRd') +
labs(title='Proporção entre aluguel e salário',
fill='Proporção')
mapa3
# Lendo o mapa do Brasil separado em seus municípios
cities <- read_municipality(year=2018, showProgress=FALSE)
# Plotando
ggplot() +
geom_sf(data=cities, fill=gray(0.85), color=gray(0.7))
# Vamos ver como é essa variavel sf
str(cities)
# Filtrando apenas as cidades que estão na RMR:
cidades_rmr <- c('Abreu E Lima', 'Araçoiaba', 'Cabo De Santo Agostinho', 'Camaragibe', 'Igarassu', 'Ilha De Itamaracá', 'Ipojuca', 'Itapissuma', 'Jaboatão Dos Guararapes', 'Moreno', 'Olinda', 'Paulista', 'Recife', 'São Lourenço Da Mata')
rmr_sf <- filter(cities, name_muni %in% cidades_rmr)
rmr_sf$geom
# Plotando o mapa da RMR com seus municípios
rmr_map <- ggplot() +
geom_sf(data=rmr_sf, fill=gray(0.85), color=gray(0.7)) +
labs(title='Região Metropolitana do Recife')
rmr_map
rmr_sf <- rmr_sf[-1,]
# Plotando o mapa da RMR com seus municípios
rmr_map <- ggplot() +
geom_sf(data=rmr_sf, fill=gray(0.85), color=gray(0.7)) +
labs(title='Região Metropolitana do Recife')
rmr_map
# Redefinindo o vetor com as cidades. Perceba que existe uma diferença entre
# as letras minúsculas das preposições
cidades_rmr <- c('Abreu e Lima', 'Araçoiaba', 'Cabo de Santo Agostinho', 'Camaragibe', 'Igarassu', 'Ilha de Itamaracá', 'Ipojuca', 'Itapissuma', 'Jaboatão dos Guararapes', 'Moreno', 'Olinda', 'Paulista', 'Recife', 'São Lourenço da Mata')
rmr_df <- filter(anunciosf, Cidade %in% cidades_rmr)
# Agrupando os dados de acordo com a cidade
rmr_df_grouped <- rmr_df %>%
group_by(Cidade) %>%
summarise(Quantidade = n(),
Media.Preco = round(mean(Preco),2)) %>%
arrange(desc(Quantidade))
datatable(rmr_df_grouped)
sct_map2 <- ggplot() +
geom_sf(data=rmr_sf, # Mapa da RMR
fill=gray(0.85),
color=gray(0.7)) +
geom_sf(data=filter(pontos_sf, Cidade %in% cidades_rmr),  # filtrando os pontos que estão na RMR
alpha=0.7,
aes(color=Preco), # definindo a cor de acordo com o preço
size=2.5,
show.legend = 'point') +
labs(title='Distribuição dos imóveis na RMR')
sct_map2
# Criando um gráfico de dispersão (scatter plot) para a variável Preço
# O gráfico divide Apartamentos e Casas em diferentes cores
plot_ly(data=anunciosf,
type='scatter',
x=~Area,
y=~Preco,
color=~Tipo,
symbol = ~Tipo,
colors=c('#FF5653', '#5A41F3'),
marker = list(size=7),
mode='markers') %>%
layout(title='Relação entre Área e Preço do imóvel',
xaxis=list(title='Área (m²)'),
yaxis=list(title='Preço'),
width=800)
# Criando um gráfico de dispersão (scatter plot) para a variável Preço
# O gráfico divide Apartamentos e Casas em diferentes cores
plot_ly(data=anunciosf,
type='scatter',
x=~Area,
y=~Preco,
color=~Tipo,
symbol = ~Tipo,
symbols = c('circle', 'x')
colors=c('#FF5653', '#5A41F3'),
# Criando um gráfico de dispersão (scatter plot) para a variável Preço
# O gráfico divide Apartamentos e Casas em diferentes cores
plot_ly(data=anunciosf,
type='scatter',
x=~Area,
y=~Preco,
color=~Tipo,
symbol = ~Tipo,
symbols = c('circle', 'x'),
colors=c('#FF5653', '#5A41F3'),
marker = list(size=7),
mode='markers') %>%
layout(title='Relação entre Área e Preço do imóvel',
xaxis=list(title='Área (m²)'),
yaxis=list(title='Preço'),
width=800)
# Criando o primeiro scatter plot, para Preço vs Quartos
sct1 <- plot_ly(data=anunciosf,
type='scatter',
x=~Quartos,
y=~Preco,
color=~Tipo,
symbol=~Tipos,
symbols=c('circle', 'x'),
colors=c('#FF5653', '#5A41F3'),
marker = list(size=7),
mode='markers') %>%
layout(xaxis=list(title='Quartos', autotick=FALSE, tick0=0, dtick=1),
yaxis=list(title='Preço'),
width = 700)
# Criando o segundo scatter plot, para Preço vs Banheiros
sct2 <- plot_ly(data=anunciosf,
type='scatter',
x=~Banheiros,
y=~Preco,
color=~Tipo,
symbol=~Tipos,
symbols=c('circle', 'x'),
colors=c('#FF5653', '#5A41F3'),
marker = list(size=7),
mode='markers',
showlegend=F) %>%
layout(xaxis=list(title='Banheiros', autotick=FALSE, tick0=0, dtick=1),
yaxis=list(title='Preço'),
width = 700)
fig2 <- subplot(sct1, sct2, titleX = T, titleY=T, shareY=T, which_layout = c(1,2))
# Criando o primeiro scatter plot, para Preço vs Quartos
sct1 <- plot_ly(data=anunciosf,
type='scatter',
x=~Quartos,
y=~Preco,
color=~Tipo,
symbol=~Tipo,
symbols=c('circle', 'x'),
colors=c('#FF5653', '#5A41F3'),
marker = list(size=7),
mode='markers') %>%
layout(xaxis=list(title='Quartos', autotick=FALSE, tick0=0, dtick=1),
yaxis=list(title='Preço'),
width = 700)
# Criando o segundo scatter plot, para Preço vs Banheiros
sct2 <- plot_ly(data=anunciosf,
type='scatter',
x=~Banheiros,
y=~Preco,
color=~Tipo,
symbol=~Tipo,
symbols=c('circle', 'x'),
colors=c('#FF5653', '#5A41F3'),
marker = list(size=7),
mode='markers',
showlegend=F) %>%
layout(xaxis=list(title='Banheiros', autotick=FALSE, tick0=0, dtick=1),
yaxis=list(title='Preço'),
width = 700)
fig2 <- subplot(sct1, sct2, titleX = T, titleY=T, shareY=T, which_layout = c(1,2))
fig2
